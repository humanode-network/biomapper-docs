---
description: Smart contracts description
---

import { Callout } from "nextra/components";

# Smart Contracts Layout

Humanode Biomapper on-chain part consists of 5 smart contracts:

- Biomapper
- Proxy for Biomapper
- SwappableStorage
- BiomapperLog
- Proxy for BiomapperLog

## Proxy

Proxy contracts that are used in Humanode Biomapper are `TransparentUpgradeableProxy` by `OpenZeppelin`.

## Biomapper

Biomapper contract consists of 2 main parts: a `Biomapper` contract itself and a `BiomapperImpl` contract. The `Biomapper` contract is derived from `BiomapperImpl`.

### Biomapper part

`Biomapper` part contract contains 2 types of functions: privileged functions to maintain `SwappableStorage` and 3 unrestricted external functions to check and prove uniqueness.

These 3 functions are:

| function        | interface        |
| --------------- | ---------------- |
| isUnique        | ICheckUniqueness |
| getPrice        | IProveUniqueness |
| proveUniqueness | IProveUniqueness |

For each of these functions, there is a function in `BiomapperImpl` with the same name that contains actual code. All 3 of these functions in `Biomapper` part make a call to `SwappableStorage`.

### BiomapperImpl part

`BiomapperImpl` part describes the state and contains functions that can access that state. Each function is restricted to delegate calls only so `BiomapperImpl` part has no state, only code.

## SwappableStorage

`SwappableStorage` is a universal contract that upon receiving any call will make a delegete call to a configured contract. This contract can receive calls from a specified contract only.

#### Example flow

An example flow for `isUnique` function:

| step | from             | to               | call type     | which state is used | which code is executed    | action                                           |
| ---- | ---------------- | ---------------- | ------------- | ------------------- | ------------------------- | ------------------------------------------------ |
| 1    | -                | Proxy            | call          | -                   | -                         | isUnique is called                               |
| 2    | Proxy            | Biomapper        | delegate call | Proxy               | Biomapper                 | Proxy delegates call to Biomapper                |
| 3    | Proxy            | SwappableStorage | call          | Proxy               | Biomapper                 | Biomapper calls isUnique of SwappableStorage     |
| 4    | SwappableStorage | Biomapper        | delegate call | SwappableStorage    | Biomapper (BiomapperImpl) | SwappableStorage delegates call to BiomapperImpl |

## BiomapperLog

`BiomapperLog` contract implements 2 interfaces:

### IBiomapperLogRead

`IBiomapperLogRead` interface is public and contains `view` functions only.

[Broken link](broken-reference)

### IBiomapperLogWrite

`IBiomapperLogWrite` interface contains functions that are restricted to be called by `Biomapper` Proxy contract.
